<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <title>StepDub</title>
  </head>
  <body>
    <h1 id="appname">StepDub</h1>
    <h1 id="active-label">Not running</h1>
    <p><a href="debug.html">Debug</a></p>
    <p><a href="about.html">About</a></p>
    <img src="shoes/spring.svg" onclick="sproing()">
    <script type="text/javascript" src="phonegap.js"></script>
    <script type="text/javascript" src="functions.js"></script>
    <script>
      /*global magAvgListener playSound*/

      "use strict";
      var mal = magAvgListener();

      function primedSpring(mag,gravity){
        var jerk = Math.abs(gravity-mag);
        if(jerk > 2){
          var counter = 0;
          playSound('sounds/boing.mp3');
          mal.setCb(function(mag,gravity){
            if(Math.abs(gravity-mag) < 1) {
              counter++;
              if(counter > 5) mal.setCb(primedSpring);
            }
          });
        }
      }

      function sproing(){
        document.getElementById("active-label").textContent = "Spring In Your Step";
        mal.setCb(primedSpring);
      }
    </script>
  </body>
</html>
